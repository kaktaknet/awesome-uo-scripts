[ITEMDEF 04000]
// Face N
DEFNAME=i_multi_ship_small_n
Name=Small Ship
TYPE=T_SHIP
VALUE=14000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Small Ship
MULTIREGION=-2,-5,2,5
COMPONENT=03e4e,1, 4	// tiller.
COMPONENT=i_ship_hatch_n,0,-4	// hatch
COMPONENT=03eb2,2,0		// plank
COMPONENT=03eb1,-2,0	// plank
TSPEECH spk_ship_cmds

ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2
	
[ITEMDEF 04001]
// Face E
DEFNAME=i_multi_ship_small_e
Name=Small Ship
TYPE=T_SHIP
VALUE=14000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Small Ship
MULTIREGION=-5,-2,5,2
COMPONENT=03e55,-4,0
COMPONENT=i_ship_hatch_e,4, 0
COMPONENT=03e85,0, 2
COMPONENT=03e8a,0,-2
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04002]
// Face S
DEFNAME=i_multi_ship_small_s
Name=Small Ship
TYPE=T_SHIP
VALUE=14000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Small Ship
MULTIREGION=-2,-5,2,5
COMPONENT=03e4b,0, -4
COMPONENT=i_ship_hatch_s,0,  4
COMPONENT=03eb2,2,  0
COMPONENT=03eb1,-2, 0
TSPEECH spk_ship_cmds

ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04003]
// Face W
DEFNAME=i_multi_ship_small_w
Name=Small Ship
TYPE=T_SHIP
VALUE=14000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Small Ship
MULTIREGION=-5,-2,5,2
COMPONENT=03e50,4, 0
COMPONENT=i_ship_hatch_w,-4,0
COMPONENT=03e85,0, 2
COMPONENT=03e8a,0,-2
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04004]
// Face N
DEFNAME=i_multi_ship_dragon_small_n
Name=Small Dragon Ship
TYPE=T_SHIP
VALUE=14500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Small Dragon Ship
MULTIREGION=-2,-5,2,5
COMPONENT=03e4e,1, 4, 0
COMPONENT=i_ship_hatch_n,0,-4, 0
COMPONENT=03eb2,2, 0, 0
COMPONENT=03eb1,-2, 0, 0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04005]
// Face E
DEFNAME=i_multi_ship_dragon_small_e
Name=Small Dragon Ship
TYPE=T_SHIP
VALUE=14500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=a mast
MULTIREGION=-5,-2,5,2
COMPONENT=03e55,-4,0
COMPONENT=i_ship_hatch_e,4, 0
COMPONENT=03e85,0, 2
COMPONENT=03e8a,0,-2
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04006]
// Face S
DEFNAME=i_multi_ship_dragon_small_s
Name=Small Dragon Ship
TYPE=T_SHIP
VALUE=14500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Small Dragon Ship
MULTIREGION=-2,-5,2,5
COMPONENT=03e4b,0, -4
COMPONENT=i_ship_hatch_s,0,  4
COMPONENT=03eb2,2,  0
COMPONENT=03eb1,-2, 0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04007]
// Face W
DEFNAME=i_multi_ship_dragon_small_w
Name=Small Dragon Ship
TYPE=T_SHIP
VALUE=14500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Small Dragon Ship
MULTIREGION=-5,-2,5,2
COMPONENT=03e50,4, 0
COMPONENT=i_ship_hatch_w,-4,0
COMPONENT=03e85,0, 2
COMPONENT=03e8a,0,-2
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04008]
// Face N
DEFNAME=i_multi_ship_medium_n
Name=Medium Ship
TYPE=T_SHIP
VALUE=16000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Medium Ship
MULTIREGION=-2,-6,2,6
COMPONENT=03e4e,1, 5, 0
COMPONENT=i_ship_hatch_n,0,-4, 0
COMPONENT=03eb2,2, 0, 0
COMPONENT=03eb1,-2, 0, 0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04009]
// Face E
DEFNAME=i_multi_ship_medium_e
Name=Medium Ship
TYPE=T_SHIP
VALUE=16000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Medium Ship
MULTIREGION=-6,-2,6,2
COMPONENT=03e55,-5,0, 0
COMPONENT=i_ship_hatch_e,4, 0, 0
COMPONENT=03e85,0, 2, 0
COMPONENT=03e8a,0,-2, 0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 0400a]
// Face S
DEFNAME=i_multi_ship_medium_s
Name=Medium Ship
TYPE=T_SHIP
VALUE=16000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Medium Ship
MULTIREGION=-2,-6,2,5
COMPONENT=03e4b,0,-5,0
COMPONENT=i_ship_hatch_s,0,4,0
COMPONENT=03eb2,2,0,0
COMPONENT=03eb1,-2,0,0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 0400b]
// Face W
DEFNAME=i_multi_ship_medium_w
Name=Medium Ship
TYPE=T_SHIP
VALUE=16000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Medium Ship
MULTIREGION=-6,-2,6,2
COMPONENT=03e50,5, 0,0
COMPONENT=i_ship_hatch_w,-4,0,0
COMPONENT=03e85,0, 2,0
COMPONENT=03e8a,0,-2,0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 0400c]
// Face N
DEFNAME=i_multi_ship_dragon_medium_n
Name=Medium Dragon Ship
TYPE=T_SHIP
VALUE=16500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Medium Dragon Ship
MULTIREGION=-2,-6,2,6
COMPONENT=03e4e,1, 5, 0
COMPONENT=i_ship_hatch_n,0,-4, 0
COMPONENT=03eb2,2, 0, 0
COMPONENT=03eb1,-2, 0, 0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 0400d]
// Face E
DEFNAME=i_multi_ship_dragon_medium_e
Name=Medium Dragon Ship
TYPE=T_SHIP
VALUE=16500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Medium Dragon Ship
MULTIREGION=-6,-2,6,2
COMPONENT=i_ship_tillerman,-5,0, 0
COMPONENT=i_ship_hatch_e,4, 0, 0
COMPONENT=03e87,0, 2, 0
COMPONENT=03e8a,0,-2, 0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 0400e]
// Face S
DEFNAME=i_multi_ship_dragon_medium_s
Name=Medium Dragon Ship
TYPE=T_SHIP
VALUE=16500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Medium Dragon Ship
MULTIREGION=-2,-6,2,5
COMPONENT=03e4b,0, -5,0
COMPONENT=i_ship_hatch_s,0,  4,0
COMPONENT=03ea9,2,  0,0
COMPONENT=03eb1,-2, 0,0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 0400f]
// Face W
DEFNAME=i_multi_ship_dragon_medium_w
Name=Medium Dragon Ship
TYPE=T_SHIP
VALUE=16500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Medium Dragon Ship
MULTIREGION=-6,-2,6,2
COMPONENT=03e50,5, 0
COMPONENT=i_ship_hatch_w,-4,0
COMPONENT=03e87,0, 2
COMPONENT=03e8a,0,-2
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04010]
// Face N
DEFNAME=i_multi_ship_long_n
Name=Long Ship
TYPE=T_SHIP
VALUE=18000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Long Ship
MULTIREGION=-2,-7,2,7
COMPONENT=03e4e,1, 5, 0
COMPONENT=i_ship_hatch_n,0,-5, 0
COMPONENT=03eb2,2, -1, 0
COMPONENT=03eb1,-2, -1, 0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04011]
// Face E
DEFNAME=i_multi_ship_long_e
Name=Long Ship
TYPE=T_SHIP
VALUE=18000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Long Ship
MULTIREGION=-7,-2,7,2
COMPONENT=03e55,-5,0, 0
COMPONENT=i_ship_hatch_e,5, 0, 0
COMPONENT=03e85,1, 2, 0
COMPONENT=03e8a,1,-2, 0
TSPEECH spk_ship_cmds

[ITEMDEF 04012]
// Face S
DEFNAME=i_multi_ship_long_s
Name=Long Ship
TYPE=T_SHIP
VALUE=18000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Long Ship
MULTIREGION=-2,-7,2,5
COMPONENT=03e4b,0, -5,0
COMPONENT=i_ship_hatch_s,0, 5,0
COMPONENT=03eb2,2, 1,0
COMPONENT=03eb1,-2, 1,0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04013]
// Face W
DEFNAME=i_multi_ship_long_w
Name=Long Ship
TYPE=T_SHIP
VALUE=18000
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Long Ship
MULTIREGION=-7,-2,7,2
COMPONENT=03e50,5, 0,0
COMPONENT=i_ship_hatch_w,-5,0,0
COMPONENT=03e85,-1, 2,0
COMPONENT=03e8a,-1,-2,0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04014]
// Face N
DEFNAME=i_multi_ship_dragon_long_n
Name=Long Dragon Ship
TYPE=T_SHIP
VALUE=18500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Long Dragon Ship
MULTIREGION=-2,-7,2,7
COMPONENT=03e4e,1, 5, 0
COMPONENT=i_ship_hatch_n,0,-5, 0
COMPONENT=03eb2,2, -1, 0
COMPONENT=03eb1,-2, -1, 0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04015]
// Face E
DEFNAME=i_multi_ship_dragon_long_e
Name=Long Dragon Ship
TYPE=T_SHIP
VALUE=18500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Long Dragon Ship
MULTIREGION=-7,-2,7,2
COMPONENT=03e55,-5,0, 0
COMPONENT=i_ship_hatch_e,5, 0, 0
COMPONENT=03e85,1, 2, 0
COMPONENT=03e8a,1,-2, 0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04016]
// Face S
DEFNAME=i_multi_ship_dragon_long_s
Name=Long Dragon Ship
TYPE=T_SHIP
VALUE=18500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Long Dragon Ship
MULTIREGION=-2,-7,2,5
COMPONENT=03e4b,0, -5,0
COMPONENT=i_ship_hatch_s,0, 5,0
COMPONENT=03eb2,2, 1,0
COMPONENT=03eb1,-2, 1,0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[ITEMDEF 04017]
// Face W
DEFNAME=i_multi_ship_dragon_long_w
Name=Long Dragon Ship
TYPE=T_SHIP
VALUE=18500
CATEGORY=Multis
SUBSECTION=Ships
DESCRIPTION=Long Dragon Ship
MULTIREGION=-7,-2,7,2
COMPONENT=03e50,5, 0,0
COMPONENT=i_ship_hatch_w,-5,0,0
COMPONENT=03e85,-1, 2,0
COMPONENT=03e8a,-1,-2,0
TSPEECH spk_ship_cmds


ON=@TARGON_ITEM
F_NAV_2
RETURN 1

ON=@TARGON_CHAR
F_NAV_CHAR
RETURN2

[FUNCTION shipfix]
IF ! 0<REGION.TAG.HATCH>
	shipinitiate
ENDIF

// Small Ships
IF (<BASEID> == i_multi_ship_small_n) || (<BASEID> == i_multi_ship_dragon_small_n)
	VAR.HATCH 0 -4 0
	VAR.TILLERMAN 1 4 0
	VAR.LEFTSIDE -2 0 0
	VAR.RIGHTSIDE 2 0 0
ELIF (<BASEID> == i_multi_ship_small_w) || (<BASEID> == i_multi_ship_dragon_small_w)
	VAR.HATCH -4 0 0
	VAR.TILLERMAN 4 0 0
	VAR.LEFTSIDE 0 2 0
	VAR.RIGHTSIDE 0 -2 0
ELIF (<BASEID> == i_multi_ship_small_s) || (<BASEID> == i_multi_ship_dragon_small_s)
	VAR.HATCH 0 4 0
	VAR.TILLERMAN 0 -4 0
	VAR.LEFTSIDE 2 0 0
	VAR.RIGHTSIDE -2 0 0
ELIF (<BASEID> == i_multi_ship_small_e) || (<BASEID> == i_multi_ship_dragon_small_e)
	VAR.HATCH 4 0 0
	VAR.TILLERMAN -4 0 0
	VAR.LEFTSIDE 0 -2 0
	VAR.RIGHTSIDE 0 2 0

// Medium Ships
ELIF (<BASEID> == i_multi_ship_medium_n) || (<BASEID> == i_multi_ship_dragon_medium_n)
	VAR.HATCH 0 -4 0
	VAR.TILLERMAN 1 5 0
	VAR.LEFTSIDE -2 0 0
	VAR.RIGHTSIDE 2 0 0
ELIF (<BASEID> == i_multi_ship_medium_w) || (<BASEID> == i_multi_ship_dragon_medium_w)
	VAR.HATCH -4 0 0
	VAR.TILLERMAN 5 0 0
	VAR.LEFTSIDE 0 2 0
	VAR.RIGHTSIDE 0 -2 0
ELIF (<BASEID> == i_multi_ship_medium_s) || (<BASEID> == i_multi_ship_dragon_medium_s)
	VAR.HATCH 0 4 0
	VAR.TILLERMAN 0 -5 0
	VAR.LEFTSIDE 2 0 0
	VAR.RIGHTSIDE -2 0 0
ELIF (<BASEID> == i_multi_ship_medium_e) || (<BASEID> == i_multi_ship_dragon_medium_e)
	VAR.HATCH 4 0 0
	VAR.TILLERMAN -5 0 0
	VAR.LEFTSIDE 0 -2 0
	VAR.RIGHTSIDE 0 2 0

// Long Ships
ELIF (<BASEID> == i_multi_ship_long_n) || (<BASEID> == i_multi_ship_dragon_long_n)
	VAR.HATCH 0 -5 0
	VAR.TILLERMAN 1 5 0
	VAR.LEFTSIDE -2 -1 0
	VAR.RIGHTSIDE 2 -1 0
ELIF (<BASEID> == i_multi_ship_long_w) || (<BASEID> == i_multi_ship_dragon_long_w)
	VAR.HATCH -5 0 0
	VAR.TILLERMAN 5 0 0
	VAR.LEFTSIDE -1 2 0
	VAR.RIGHTSIDE -1 -2 0
ELIF (<BASEID> == i_multi_ship_long_s) || (<BASEID> == i_multi_ship_dragon_long_s)
	VAR.HATCH 0 5 0
	VAR.TILLERMAN 0 -5 0
	VAR.LEFTSIDE 2 1 0
	VAR.RIGHTSIDE -2 1 0
ELIF (<BASEID> == i_multi_ship_long_e) || (<BASEID> == i_multi_ship_dragon_long_e)
	VAR.HATCH 5 0 0
	VAR.TILLERMAN -5 0 0
	VAR.LEFTSIDE 1 -2 0
	VAR.RIGHTSIDE 1 2 0
ENDIF

TRY UID.<REGION.TAG.HATCH>.hatchfix
TRY UID.<REGION.TAG.TILLERMAN>.tillermanfix
TRY UID.<REGION.TAG.LEFTSIDE>.leftsidefix
TRY UID.<REGION.TAG.RIGHTSIDE>.rightsidefix

[FUNCTION hatchfix]
IF (<LINK.MORE2> == 00)	|| (<LINK.MORE2> == 01) || (<LINK.MORE2> == 02)				// N
	DISPID 03eae
ELIF (<LINK.MORE2> == 02020000)	|| (<LINK.MORE2> == 02020001) || (<LINK.MORE2> == 02020002)	// E
	DISPID i_ship_hatch_e
ELIF (<LINK.MORE2> == 04040000)	|| (<LINK.MORE2> == 04040001) || (<LINK.MORE2> == 04040002)	// S
	DISPID 03eb9
ELIF (<LINK.MORE2> == 06060000)	|| (<LINK.MORE2> == 06060001) || (<LINK.MORE2> == 06060002)	// W
	DISPID 03e93
ENDIF
P <LINK.P>
MOVE <VAR.HATCH>

[FUNCTION tillermanfix]
IF (<LINK.MORE2> == 00)	|| (<LINK.MORE2> == 01) || (<LINK.MORE2> == 02)				// N
	DISPID 03e4e
ELIF (<LINK.MORE2> == 02020000)	|| (<LINK.MORE2> == 02020001) || (<LINK.MORE2> == 02020002)	// E
	DISPID 03e55
ELIF (<LINK.MORE2> == 04040000)	|| (<LINK.MORE2> == 04040001) || (<LINK.MORE2> == 04040002)	// S
	DISPID 03e4b
ELIF (<LINK.MORE2> == 06060000)	|| (<LINK.MORE2> == 06060001) || (<LINK.MORE2> == 06060002)	// W
	DISPID 03e50
ENDIF
P <LINK.P>
MOVE <VAR.TILLERMAN>

[FUNCTION leftsidefix]
IF (<LINK.MORE2> == 00)	|| (<LINK.MORE2> == 01) || (<LINK.MORE2> == 02)				// N
	SRC.NEWITEM 03eb1
	SRC.ACT.P <LINK.P>
	SRC.ACT.MOVE <VAR.LEFTSIDE>
	plankfix
ELIF (<LINK.MORE2> == 02020000)	|| (<LINK.MORE2> == 02020001) || (<LINK.MORE2> == 02020002)	// E
	SRC.NEWITEM i_ship_plank_n_c
	SRC.ACT.P <LINK.P>
	SRC.ACT.MOVE <VAR.LEFTSIDE>
	plankfix
ELIF (<LINK.MORE2> == 04040000)	|| (<LINK.MORE2> == 04040001) || (<LINK.MORE2> == 04040002)	// S
	SRC.NEWITEM 03eb2
	SRC.ACT.P <LINK.P>
	SRC.ACT.MOVE <VAR.LEFTSIDE>
	plankfix
ELIF (<LINK.MORE2> == 06060000)	|| (<LINK.MORE2> == 06060001) || (<LINK.MORE2> == 06060002)	// W
	SRC.NEWITEM 03e85
	SRC.ACT.P <LINK.P>
	SRC.ACT.MOVE <VAR.LEFTSIDE>
	plankfix
ENDIF
REGION.TAG.LEFTSIDE <SRC.ACT.UID>

[FUNCTION rightsidefix]
IF (<LINK.MORE2> == 00)	|| (<LINK.MORE2> == 01) || (<LINK.MORE2> == 02)				// N
	SRC.NEWITEM 03eb2
	SRC.ACT.P <LINK.P>
	SRC.ACT.MOVE <VAR.RIGHTSIDE>
	plankfix
ELIF (<LINK.MORE2> == 02020000)	|| (<LINK.MORE2> == 02020001) || (<LINK.MORE2> == 02020002)	// E
	SRC.NEWITEM 03e85
	SRC.ACT.P <LINK.P>
	SRC.ACT.MOVE <VAR.RIGHTSIDE>
	plankfix
ELIF (<LINK.MORE2> == 04040000)	|| (<LINK.MORE2> == 04040001) || (<LINK.MORE2> == 04040002)	// S
	SRC.NEWITEM 03eb1
	SRC.ACT.P <LINK.P>
	SRC.ACT.MOVE <VAR.RIGHTSIDE>
	plankfix
ELIF (<LINK.MORE2> == 06060000)	|| (<LINK.MORE2> == 06060001) || (<LINK.MORE2> == 06060002)	// W
	SRC.NEWITEM i_ship_plank_n_c
	SRC.ACT.P <LINK.P>
	SRC.ACT.MOVE <VAR.RIGHTSIDE>
	plankfix
ENDIF
REGION.TAG.RIGHTSIDE <SRC.ACT.UID>

[FUNCTION plankfix]
SRC.ACT.MORE1 <MORE1>
SRC.ACT.MORE2 <MORE2>
SRC.ACT.ATTR <ATTR>
SRC.ACT.LINK <LINK>

IF (<TYPE> == t_ship_plank)
	SRC.ACT.TYPE t_ship_side
	SRC.ACT.DCLICK
ELSE
	SRC.ACT.TYPE <TYPE>
ENDIF

REMOVE

[SPEECH spk_ship_cmds]

ON=Set name *
// Changes Ship's name, where *=name.
// NAME=<strmid(<args>,8,64)>

ON=Furl sail			// Stop
ON=Stop				// Stops current ship movement.
	SHIPSTOP

ON=Turn Left
ON=Port				// Turn Left
	f_turn_ship
	if 0<var.bump>=0
	SHIPTURNLEFT
	SHIPFIX
	else
	src.act=0<REGION.TAG.TILLERMAN>
	src.act.say Arg! can't turn here captain.
	endif

ON=Turn Right
ON=Starboard
	f_turn_ship	
	if 0<var.bump>=0		// Turn Right
	SHIPTURNRIGHT
	SHIPFIX
	f_start_ship
	else
	src.act=0<REGION.TAG.TILLERMAN>
	src.act.say Arg! can't turn here captain.
	endif

ON=Left				// Move ship in desired direction.
ON=Drift Left
	SHIPDRIFTLEFT
	f_start_ship
ON=Right			// Move ship in desired direction.
ON=Drift Right
	SHIPDRIFTRIGHT
	f_start_ship
ON=Back				// Move ship backwards
ON=Backward			// Move ship backwards
ON=Backwards			// Move ship backwards
	SHIPBACK
	f_start_ship
ON=Forward
ON=Foreward			// Moves ship forward.
ON=Unfurl sail			// Moves ship forward.
	SHIPFORE
	f_start_ship
ON=Forward left
	SHIPFORELEFT
	f_start_ship
ON=forward right
	SHIPFORERIGHT
	f_start_ship
ON=backward left
ON=back left
	SHIPBACKLEFT
	f_start_ship
ON=backward right
ON=back right
	SHIPBACKRIGHT
	f_start_ship
ON=Raise Anchor
	SHIPANCHORRAISE

ON=Drop Anchor
	SHIPANCHORDROP

ON=Turn around			// Turns ship around and proceeds.
ON=Come about			// Turns ship around and proceeds.
	SHIPTURN
	SHIPFIX
	f_start_ship
ON=Up
	SHIPUP

ON=Down
	SHIPDOWN

ON=Land
	SHIPLAND

on=test
f_turn_ship

on=nav
src.findlayer.21.dclick
f_nav

[FUNCTION F_NAV_2]
	src.act=0<REGION.TAG.TILLERMAN>
	if 0<src.targ.uid>=0<src.act.uid>
		src.act.say Stop that!
	elif <src.targ..type>!=t_map
		src.act.say That is not a map captain!
	elif <src.targ.more1l>><p.x>
		src.act.say I don't know were that is captain! Maybe we should plot a corse on the world map!
	elif <src.targ.more1h>><p.y>
		src.act.say I don't know were that is captain! Maybe we should plot a corse on the world map!
	elif <src.targ.more2l><<p.x>
		src.act.say I don't know were that is captain! Maybe we should plot a corse on the world map!
	elif <src.targ.more2h><<p.y>
		src.act.say I don't know were that is captain! Maybe we should plot a corse on the world map!
	else
		try var.morep <src.targ.morep>
		src.targ.get_map_p 1
		tag.mapx=<src.targ.morex>
		tag.mapy=<src.targ.morey>
		if (0<tag.mapx><1)|(0<tag.mapy><1)
			src.act.say I don't know were that is captain!
		else
			tag.pin=1
			tag.map=<src.targ.uid>
			src.act.say Aye Captain! setting corse! Full speed ahead!
			if 0<tag.mapx>><p.x>
				shipturn
			shipfore
			more2=<eval <more2>+1>
			f_start_ship
		endif
	endif

[FUNCTION F_NAV_CHAR]
	src.act=0<REGION.TAG.TILLERMAN>
	src.act.say I don't think that is a map captain!

[FUNCTION shipinitiate]
SRC.NEWITEM i_gold
VAR.UID <SRC.ACT>
SRC.ACT.P <P>
SRC.ACT.MOVE nw 10
SRC.NUKE shipinitiate_n <UID>
SRC.LAST
SRC.ACT.MOVE se 20
SRC.LAST
TRY UID.<VAR.UID>.REMOVE
VAR.UID

SRC.HIDEMESSAGE
SRC.SYSMESSAGE Please cancel this target cursor (Esc key), targetting an object will have no effect.

[FUNCTION shipinitiate_n]
IF (<UID> != <ARGN>) && (<LINK.UID> == <ARGN>) && (<REGION.UID> == <LINK.REGION.UID>)
	IF (<TYPE> == t_ship_side) || (<TYPE> == t_ship_side_locked) || (<TYPE> == t_ship_plank) || (<TYPE> == t_ship_tiller) || (<TYPE> == t_ship_hold_lock) || (<TYPE> == t_ship_hold)
		IF (<TYPE> == t_ship_hold) || (<TYPE> == t_ship_hold_lock)
			LINK.REGION.TAG.HATCH <UID>
		ELIF (<TYPE> == t_ship_tiller)
			LINK.REGION.TAG.TILLERMAN <UID>
		ELSE
			IF (<LINK.MORE2> == 00)	|| (<LINK.MORE2> == 01) || (<LINK.MORE2> == 02)				// N
				IF (<P.X> > <LINK.P.X>)
					LINK.REGION.TAG.RIGHTSIDE <UID>
				ELIF (<P.X> < <LINK.P.X>)
					LINK.REGION.TAG.LEFTSIDE <UID>
				ENDIF
			ELIF (<LINK.MORE2> == 02020000)	|| (<LINK.MORE2> == 02020001) || (<LINK.MORE2> == 02020002)	// E
				IF (<P.Y> > <LINK.P.Y>)
					LINK.REGION.TAG.RIGHTSIDE <UID>
				ELIF (<P.Y> < <LINK.P.Y>)
					LINK.REGION.TAG.LEFTSIDE <UID>
				ENDIF
			ELIF (<LINK.MORE2> == 04040000)	|| (<LINK.MORE2> == 04040001) || (<LINK.MORE2> == 04040002)	// S
				IF (<P.X> < <LINK.P.X>)
					LINK.REGION.TAG.RIGHTSIDE <UID>
				ELIF (<P.X> > <LINK.P.X>)
					LINK.REGION.TAG.LEFTSIDE <UID>
				ENDIF
			ELIF (<LINK.MORE2> == 06060000)	|| (<LINK.MORE2> == 06060001) || (<LINK.MORE2> == 06060002)	// W
				IF (<P.Y> < <LINK.P.Y>)
					LINK.REGION.TAG.RIGHTSIDE <UID>
				ELIF (<P.Y> > <LINK.P.Y>)
					LINK.REGION.TAG.LEFTSIDE <UID>
				ENDIF
			ENDIF
		ENDIF
	ENDIF
ENDIF

[FUNCTION hidemessage]
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE
SYSMESSAGE


[function get_map_p]
morep=<pin.<args>>
var.num1=100
morex=<eval <more1h>+((<more2h>-<more1h>)/194)*<morex>))>
morey=<eval <more1l>+((<more2l>-<more1l>)/194)*<morey>))>

[function go_pin]
get_map_p <args>
src.go <morep>
src.fix
src.say <morep>

[function f_start_ship]
src.say start
var.act=<src.act.uid>
src.act=0<tag.shipwatch>
if 0<src.act.uid>=0
 src.newitem i_ship_watch
 src.act.p=<p>
 src.act.fix
 src.act.link=<uid>
 tag.shipwatch=<src.act.uid>
 src.act.timerd=1
endif
src.act=<var.act>
var.act

[itemdef i_ship_watch]
id=02007
type=t_eq_script
layer=30

on=@create
attr=attr_decay

on=@timer
timerd=1
if <link.p.x><5120
 link.wrapx
endif
if <link.p.x><5120
 link.wrapy
endif
if (<link.more2>&01)|(<link.more2>&02)
else
link.tag.shipwatch
remove
endif
return 1

[function wrapx]
if <p.x>>5100
 shipgate 20,<p.y>
elif <p.x><20
 shipgate 5100,<p.y>
endif

[function wrapy]
if <p.y>>4086
 shipgate <p.x>,8,<mapplane>,<z>
elif <p.y><8
 shipgate <p.x>,4086,<mapplane>,<z>
endif

[function f_turn_ship]
IF (<BASEID> == i_multi_ship_small_n) || (<BASEID> == i_multi_ship_dragon_small_n) || (<BASEID> == i_multi_ship_small_s) || (<BASEID> == i_multi_ship_dragon_small_s)
var.length=4
f_turn_check_ns
ELIF (<BASEID> == i_multi_ship_small_w) || (<BASEID> == i_multi_ship_dragon_small_w) ||(<BASEID> == i_multi_ship_small_e) || (<BASEID> == i_multi_ship_dragon_small_e)
var.length=4
f_turn_check_ew
// Medium Ships
ELIF (<BASEID> == i_multi_ship_medium_n) || (<BASEID> == i_multi_ship_dragon_medium_n) || (<BASEID> == i_multi_ship_medium_s) || (<BASEID> == i_multi_ship_dragon_medium_s)
var.length=5
f_turn_check_ns
ELIF (<BASEID> == i_multi_ship_medium_w) || (<BASEID> == i_multi_ship_dragon_medium_w) || (<BASEID> == i_multi_ship_medium_e) || (<BASEID> == i_multi_ship_dragon_medium_e)
var.length=5
f_turn_check_ew
// Long Ships
ELIF (<BASEID> == i_multi_ship_long_n) || (<BASEID> == i_multi_ship_dragon_long_n) || (<BASEID> == i_multi_ship_long_s) || (<BASEID> == i_multi_ship_dragon_long_s)
var.length=6
f_turn_check_ns
say 0<var.bump>
ELIF (<BASEID> == i_multi_ship_long_w) || (<BASEID> == i_multi_ship_dragon_long_w) || (<BASEID> == i_multi_ship_long_e) || (<BASEID> == i_multi_ship_dragon_long_e)
var.length=6
f_turn_check_ew
ENDIF

[function f_turn_check_ns]
src.newitem 0eed
src.act.p=<p>
src.act.move 3,<eval 0<var.length>>
var.bump
var.num
var.num1
f_turn_checkns1
var.num
var.num1
if 0<var.bump>=1
else
	src.act.p=<p>
	src.act.move -6,<eval 0<var.length>>
	f_turn_checkns1
	var.num
	var.num1
endif
if 0<src.act.uid>!=0
	src.act.remove
endif

[function f_turn_checkns1]
if (0<var.bump>=0)
	if 0<var.num><(0<var.length>+1)
		if 0<var.num1><(0<var.length>*2)
			src.act.fix
			if <src.act.z>><z>
				var.bump=1
				src.act.remove
			else
				src.act.move 0,-1
				var.num1=<eval 0<var.num1>+1>
				f_turn_checkns1
			endif
		else
			var.num=<eval 0<var.num>+1>
			var.num1
			src.act.p=<p>
			src.act.move <eval 3+<var.num1>>,<eval 0<var.length>>
			f_turn_checkns1
		endif
	endif
endif

[function f_turn_check_ew]
src.newitem 0eed
src.act.p=<p>
src.act.move 3,<eval 0<var.length>>
var.bump
var.num
var.num1
f_turn_checkew1
var.num
var.num1
if 0<var.bump>=1
else
	src.act.p=<p>
	src.act.move <eval 0<var.length>>,-3
	f_turn_checkew1
	var.num
	var.num1
endif
if 0<src.act.uid>!=0
	src.act.remove
endif

[function f_turn_checkew1]
if (0<var.bump>=0)
	if 0<var.num><(0<var.length>+1)
		if 0<var.num1><(0<var.length>*2)
			src.act.fix
			if <src.act.z>><z>
				var.bump=1
				src.act.remove
			else
				src.act.move -1,0
				var.num1=<eval 0<var.num1>+1>
				f_turn_checkew1
			endif
		else
			var.num=<eval 0<var.num>+1>
			var.num1
			src.act.p=<p>
			src.act.move <eval 3+<var.num1>>,<eval 0<var.length>>
			f_turn_checkew1
		endif
	endif
endif

[function f_nav]
	src.act=0<REGION.TAG.TILLERMAN>
	src.act.say Show me the map captain!
	target
	
[EOF]