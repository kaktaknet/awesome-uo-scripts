//*************************************************************************
// Kenton's RP Check Script.. This script will detect players not RolePlaying
// It will tell them what words to use instead of none roleplaying words.
// It will help them learn RP along the way.. also jail them for using bad words
// To much! You can also add your own words to it .It keeps a warning level and a
// total number of
// offenses for every player. some words do not give warning lvls for a reason.
// The warning level goes up whenever someone does not RP, and will decay at a rate
// of 1
// per 8 hours. ive tested and it works fine in sphere 55i
//-------------------------------------------------------------------------
// Built on Krilldonia Online profanity detection script by Wpn-z-
// V1.25
//-------------------------------------------------------------------------
// Credits go to Kell for the idea
// behind speech recognition items
//-------------------------------------------------------------------------


//To use this script, you can choose one of the following options:
//  a) Add the i_speech_detect_stone somewhere in the world.  It must be placed on the ground to work, if it is in a container it will not function properly.
//  b) Add the e_speech_detect event to every player on your shard
//  c) Add what's in the e_speech_detect event to an event that every player on your shard has.
//  d) Slap sumptin else together that works and use it
//  Note: Option (a) is recommended for easiest use


//In-Game commands:
//  Player
//    SpeechInfo - Displays the player's none RP warning level and total none rp offenses.
//    XSpeechInfo - Displays the player's none rp warning level and total none rp offenses to GM.
//    Speech_Unjail - Forgives player from jail for using excessive none rp, but does not set their none rp warning level.
//    Speech_ClearWarning - Sets player's none rp warning level to 0.
//    Speech_ClearOffense - Sets the player's none rp offenses to 0.
//    Speech_Fix - If a player is outside of jail still displays the Jailed for none rp... Tag above his/her head, you may use this command to fix him/her. (Although this should not happen if nothing is tampered with)

//Visit http://www.kentonsscripts.cjb.net/ For the latest updates of my scripts


[DEFNAME PDOPTS]

//Profanity Detection Options

// Below you may select who none roleplaying detection will not apply to
// Note: Profanity Detection is always applied to players
//       If GM's have .GM off, they will be recognized as a player

// 0=Not Applied | 1=Applied
pd_2_applied		1	// Counseler
pd_3_applied		1	// Seer
pd_4_applied		0	// GM
pd_5_applied		0	// Developer
pd_6_applied		0	// Administrator
pd_7_applied		0	// Owner

// Default Timer for the world speech detect stone to perform checks on all clients for speech detection item (in seconds)
// Only change this if you know what you are doing
pd_worldstone_timer	5

// Decay Rate of Warning Level (in seconds)
// Note: Will still decay while logged out.
pd_warning_decay	1*05*60

// Clear warning level when Speech_Unjail command is used
// 1=True, 0=False
pd_unjail_clearwarning	1

// Initial Jail Time at warning level 6 (in seconds)
pd_jailtime_initial	1*10*60

// Additional Jail Time for every offense while jailed for none roleplaying
pd_jailtime_additional	1*05*60

// Clear warning level when jail time is up and automatically released from jail
// 1=True, 0=False
pd_jailup_clearwarning 1

// When released from jail:
// 0=Forgiven, but remains in jail cell
// 1=Sent to location he/she was at, before he/she was jailed
pd_jailp_onrelease	1

// Fines for different warning levels
pd_warning_1_fine	0
pd_warning_2_fine	0
pd_warning_3_fine	0
pd_warning_4_fine	0
pd_warning_5_fine	0
pd_warning_6_fine	0

[PLEVEL 1]
SpeechInfo

[PLEVEL 4]
Speech_Unjail
Speech_ClearWarning
Speech_ClearOffense

[ITEMDEF i_speech_detect_stone]
ID=01184
NAME=None Role Playing Detection Stone
WEIGHT=1000
TYPE=t_script

ON=@Create
ATTR=0090
COLOR=07a5
TAG.TIMER=pd_worldstone_timer
TIMER=<TAG.TIMER>

ON=@Click
IF (<TIMER> > <TAG.TIMER>) || (<TIMER>==-1)
	TIMER=<TAG.TIMER>
ENDIF
RETURN 0

ON=@Dclick
IF (<TIMER> > <TAG.TIMER>) || (<TIMER>==-1)
	TIMER=<TAG.TIMER>
ENDIF
RETURN 1

ON=@Timer
SERV.ALLCLIENTS f_speech_detect
TIMER=<TAG.TIMER>
RETURN 1

CATEGORY=none roleplaying Detection
SUBSECTION=Stone
DESCRIPTION=none roleplaying detection stone

[EVENTS e_speech_detect]
ON=@Login
f_speech_detect
RETURN 0

[FUNCTION SPEECHINFO]
IF (<SRC.UID>==<UID>)
	SYSMESSAGE=You have a un-roleplaying warning level of <EVAL <TAG.CURSELVL>>, and a total of <EVAL <TAG.CURSENUM>> un-roleplaying offenses.
ELSE
	SRC.SYSMESSAGE=<SRC.NAME> has a un-roleplaying warning level of <EVAL <TAG.CURSELVL>>, and a total of <EVAL <TAG.CURSENUM>> un-roleplaying offenses.
ENDIF

[FUNCTION SPEECH_UNJAIL]
NEWITEM=i_speech_targeter
ACT.TAG.N=1
ACT.P=<P>
ACT.TARGET Select the person you wish to forgive for excessive un-roleplaying.

[FUNCTION SPEECH_CLEARWARNING]
NEWITEM=i_speech_targeter
ACT.TAG.N=2
ACT.P=<P>
ACT.TARGET Select the person you wish to remove the un-roleplaying warning level of.

[FUNCTION SPEECH_CLEAROFFENSE]
NEWITEM=i_speech_targeter
ACT.TAG.N=3
ACT.P=<P>
ACT.TARGET Select the person you wish to remove the un-roleplaying offenses of.

[FUNCTION SPEECH_FIX]
NEWITEM=i_speech_targeter
ACT.TAG.N=4
ACT.P=<P>
ACT.TARGET Select the person you wish to fix un-roleplaying

[ITEMDEF i_speech_targeter]
ID=i_memory
NAME=Speech Unjail Targeter
TYPE=t_script

ON=@Create
ATTR=0090
TIMER=120 //Timer so this item will decay eventually if not used

ON=@TargOn_Char
IF (<TAG.N>==1)
	IF (<SRC.TARG.RESTEST 1 i_speech_jail>)
		SRC.TARG.CONSUME=1 i_speech_jail
		SRC.SYSMESSAGE=You forgive <SRC.TARG.NAME> for un-roleplaying conversation.
		SRC.TARG.SYSMESSAGE=You have been forgiven for your excessive use of un-roleplaying conversation.
		VAR.PDOPT=pd_unjail_clearwarning
		IF (<VAR.PDOPT>==1)
			SRC.TARG.TAG.CURSELVL=0
		ENDIF
	ELSE
		SRC.SYSMESSAGE=<SRC.TARG.NAME> was not jailed for un-roleplaying conversation.
	ENDIF
ELIF (<TAG.N>==2)
	SRC.TARG.TAG.CURSELVL=0
	SRC.SYSMESSAGE=<SRC.TARG.NAME>'s un-roleplaying warning level has been set to 0.
	SRC.TARG.SYSMESSAGE=Your un-roleplaying warning level has been set to 0.
ELIF (<TAG.N>==3)
	SRC.TARG.TAG.CURSENUM=0
	SRC.SYSMESSAGE=<SRC.TARG.NAME>'s un-roleplaying offenses have been set to 0.
	SRC.TARG.SYSMESSAGE=Your un-roleplaying offenses have been set to 0.
ELIF (<TAG.N>==4)
	SRC.TARG.CONSUME 5 i_speech_jail
	SRC.TARG.EVENTS=-e_speech_jail
	SRC.TARG.TAG.SJP=
ENDIF
REMOVE
RETURN 1

ON=@Timer
REMOVE
RETURN 1

[FUNCTION f_speech_detect]
IF (<RESTEST 1 i_speech_detect>)
	FINDID.i_speech_detect.EQUIP
ELSE
	NEWITEM=i_speech_detect
	EQUIP=<ACT.UID>
ENDIF
	

[ITEMDEF i_speech_detect]
ID=i_worldgem_bit
NAME=un-roleplaying
TYPE=t_comm_crystal
LAYER=99

ON=@Create
SPEECH=spk_speech_detect
TYPE=t_eq_script

ON=@Equip
TYPE=t_comm_crystal
SRC.FLAGS=<SRC.FLAGS>|08000
ATTR=<ATTR>|attr_newbie|attr_move_never

ON=@Timer
TIMER=pd_warning_decay
IF (<CONT.TAG.CURSELVL> > 0)
	CONT.TAG.CURSELVL=<EVAL <CONT.TAG.CURSELVL>+(-1)>
ENDIF
RETURN 1

[SPEECH spk_speech_detect]
ON=*blowjob*
ON=*blow job*
SRC.f_curse_num 'Blowjob' un-roleplaying, please roleplay.

ON=*pussy*
SRC.f_curse_num 'Pussy' un-roleplaying, please roleplay.

ON=cunt
ON=* cunt
ON=cunt *
ON=* cunt *
SRC.f_curse_num 'Cunt' un-roleplaying, please roleplay.

ON=*fagot*
SRC.f_curse_num 'Fagot' un-roleplaying, please roleplay.

ON=*faggot*
SRC.f_curse_num 'Faggot' un-roleplaying, please roleplay.

ON=fag
ON=* fag
ON=fag *
ON=* fag *
SRC.f_curse_num 'Fag' un-roleplaying, please roleplay.

ON=ass
ON=* ass
ON=ass *
ON=* ass *
ON=*asswipe*
SRC.f_curse_num 'Ass' un-roleplaying, please roleplay.

ON=*asshole*
SRC.f_curse_num 'Asshole' un-roleplaying, please roleplay.

ON=*dumbass*
SRC.f_curse_num 'Dumbass' un-roleplaying, please roleplay.

ON=shit
ON=shit *
ON=* shit
ON=* shit *
ON=*s h i t*
ON=*bullshit*
SRC.f_curse_num 'Shit' un-roleplaying, please roleplay.

ON=*bitch*
ON=*bytch*
ON=*bitsh*
ON=*bich*
ON=*biatch*
ON=*beotch*
ON=*beeotch*
SRC.f_curse_num 'Bitch' un-roleplaying, please roleplay.

ON=*fuck*
ON=*fuk*
SRC.f_curse_num 'Fuck' un-roleplaying, please roleplay.

ON=*dude*
ON=*dood*
SRC.f_curse_num 'dood-dude' un-roleplaying, please roleplay.

ON=yo
SRC.f_curse_num 'yo' un-roleplaying, please roleplay.

ON=dawg
SRC.f_curse_num 'dawg' please use "Dog" un-roleplaying, please roleplay.

ON=*kill*
src.message 'kill' please use "slay - smite - be fouled - be felled - vanquished" un-roleplaying, please roleplay.

ON=*hey*
src.message 'hey' use, ' friend - Sir - Mam ' un-roleplaying, please roleplay.

ON=*you*
ON=*your*
src.message 'your-you' Please use "thou-thee-ye-yer" un-roleplaying, please roleplay

ON=hi
ON=hello
src.message 'hi-hello' Please use "Hail-Good Day-Greetings" un-roleplaying, please roleplay

ON=*hehe*
ON=*haha*
src.message 'Please emote *Laughs*-*Snickers*-*giggles* un-roleplaying, please roleplay.

ON=*:)*
ON=*:P*
ON=*lol*
ON=*lmao*
ON=*:D*
ON=*l0l*
ON=*l o l*
ON=*101*
ON=*1o1*
ON=*1 0 1*
ON=*l 0 l*
ON=*8)*
ON=*^_^*
src.message 'please emote *smiles* *Laughs* & so on.. un-roleplaying, please roleplay.

ON=*
IF (<SRC.UID>==<CONT.UID>)
IF (<TIMER> > pd_warning_decay) || (<TIMER>==-1)
	TIMER=pd_warning_decay
ENDIF

[FUNCTION f_curse_num]
IF (<GM>)
	VAR.PDOPT=pd_<EVAL <ACCOUNT.PLEVEL>>_applied
	IF (<ACCOUNT.PLEVEL>==2) && (<VAR.PDOPT>==1)
		RETURN 1
	ELIF (<ACCOUNT.PLEVEL>==3) && (<VAR.PDOPT>==0)
		RETURN 1
	ELIF (<ACCOUNT.PLEVEL>==4) && (<VAR.PDOPT>==0)
		RETURN 1
	ELIF (<ACCOUNT.PLEVEL>==5) && (<VAR.PDOPT>==0)
		RETURN 1
	ELIF (<ACCOUNT.PLEVEL>==6) && (<VAR.PDOPT>==0)
		RETURN 1
	ELIF (<ACCOUNT.PLEVEL>==7) && (<VAR.PDOPT>==0)
		RETURN 1
	ENDIF
ENDIF

src.message <ARGS>
IF (0<TAG.CURSENUM>==0)
	TAG.CURSENUM=0
ENDIF
IF (0<TAG.CURSELVL>==0)
	TAG.CURSELVL=0
ENDIF
TAG.CURSENUM=<EVAL <TAG.CURSENUM>+1>
TAG.CURSELVL=<EVAL <TAG.CURSELVL>+1>
FINDID.i_speech_detect.TIMER=pd_warning_decay
SAY That is offense #<EVAL <TAG.CURSENUM>>; your warning level is at <EVAL <TAG.CURSELVL>>.
IF (<TAG.CURSELVL> > 6)
	VAR.PDOPT=pd_warning_6_fine
ELSE
	VAR.PDOPT=pd_warning_<EVAL <TAG.CURSELVL>>_fine
ENDIF
IF (<TAG.CURSELVL> >=6)
	IF (!<SRC.RESTEST 1 i_speech_jail>)
		SYSMESSAGE
		SYSMESSAGE Alright, I've given you enough chances to roleplay.
		SYSMESSAGE
		SYSMESSAGE un-roleplaying, please roleplay on A.E.
		SYSMESSAGE You will be jailed for 10 mins
		SYSMESSAGE for each un role play you say in jail you get another 5 min.
		SYSMESSAGE
		NEWITEM=i_speech_jail
		EQUIP=<SRC.ACT.UID>
	ELSE
		SYSMESSAGE
		SYSMESSAGE Adds another 5 mins to your jail time. un-roleplaying, please roleplay on A.E.
		SYSMESSAGE
		FINDID.i_speech_jail.TIMER=<FINDID.i_speech_jail.TIMER>+(pd_jailtime_additional)
	ENDIF
	IF (<RESTEST <EVAL <VAR.PDOPT>> i_gold>)
		CONSUME=<EVAL <VAR.PDOPT>> i_gold
		f_randmsg_takegold
	ELSE
		IF (0<TAG.GOLDOWED>==0)
			TAG.GOLDOWED=0
		ENDIF
		TAG.GOLDOWED=<EVAL <TAG.GOLDOWED>+<VAR.PDOPT>>
	
	ENDIF
ELSEIF (<TAG.CURSELVL> >=1)
	IF (<TAG.CURSELVL> >=4)
		
	ENDIF
	IF (<RESTEST <EVAL <VAR.PDOPT>> i_gold>)
		CONSUME=<EVAL <VAR.PDOPT>> i_gold
		f_randmsg_takegold
	ELSE
		IF (0<TAG.GOLDOWED>==0)
			TAG.GOLDOWED=0
		ENDIF
		TAG.GOLDOWED=<EVAL <TAG.GOLDOWED>+<VAR.PDOPT>>
		
	ENDIF

[FUNCTION f_randmsg_takegold]


[ITEMDEF i_speech_jail]
ID=i_memory
NAME=Speech Jail Item
WEIGHT=0
TYPE=t_eq_script

ON=@Equip
SRC.EVENTS=+e_speech_jail
SRC.TAG.SJP=<SRC.P>
SRC.JAIL
TIMER=pd_jailtime_initial
RETURN 0

ON=@UnEquip
SRC.EVENTS=-e_speech_jail
SRC.FORGIVE
VAR.PDOPT=pd_jailp_onrelease
IF (<VAR.PDOPT>==0)
ELIF (<VAR.PDOPT>==1)
	SRC.GO=<SRC.TAG.SJP>
ENDIF
SRC.SYSMESSAGE You have regained your freedom, but please roleplay next time.
SRC.TAG.SJP=
VAR.PDOPT=pd_jailup_clearwarning
IF (<VAR.PDOPT>==1)
	SRC.TARG.TAG.CURSELVL=0
ENDIF

ON=@Timer
REMOVE
RETURN 1

[EVENTS e_speech_jail]
ON=@Click
TAG.JHOURS=<EVAL (<FINDID.i_speech_jail.TIMER>/3600)>
TAG.JMINS=<EVAL ((<FINDID.i_speech_jail.TIMER>/60)+(-<TAG.JHOURS>*60))>
TAG.JSECS=<EVAL ((<FINDID.i_speech_jail.TIMER>+(-(<TAG.JHOURS>*3600)))+(-(<TAG.JMINS>*60)))>
MESSAGE [Jailed for un-roleplaying, please roleplay on A.E.; <EVAL <TAG.JHOURS>> hours, <EVAL <TAG.JMINS>> minutes, and <EVAL <TAG.JSECS>> seconds left of jail time]
MESSAGE
TAG.JHOURS=
TAG.JMINS=
TAG.JSECS=

[EOF]